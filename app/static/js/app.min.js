var App;(()=>{"use strict";var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,"string");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:String(n)}(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.overlay=null,this.tooltip=null,this.currentTarget=null,this.init()}var e,o;return e=t,(o=[{key:"init",value:function(){var t=this;Shiny.addCustomMessageHandler("updateWalkthroughStep",(function(e){t.showStep(e)})),Shiny.addCustomMessageHandler("hideWalkthrough",(function(e){t.hide(e)})),this.removeDefaultTooltips()}},{key:"removeDefaultTooltips",value:function(){this.observer=null,document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("[title]").forEach((function(t){t.getAttribute("title")&&t.getAttribute("title").includes("<")&&t.removeAttribute("title")}))})),this.observer=new MutationObserver((function(t){t.forEach((function(t){"childList"===t.type&&t.addedNodes.forEach((function(t){1===t.nodeType&&((t.querySelectorAll?t.querySelectorAll("[title]"):[]).forEach((function(t){t.getAttribute("title")&&t.getAttribute("title").includes("<")&&t.removeAttribute("title")})),t.getAttribute&&t.getAttribute("title")&&t.getAttribute("title").includes("<")&&t.removeAttribute("title"))}))}))})),this.observer.observe(document.body,{childList:!0,subtree:!0})}},{key:"showStep",value:function(t){if(this.overlay=document.getElementById("app-walkthrough_overlay"),this.tooltip=document.getElementById("app-walkthrough_tooltip"),this.overlay&&this.tooltip){document.getElementById("app-step_title").textContent=t.title,document.getElementById("app-step_content").textContent=t.content,document.getElementById("app-step_counter").textContent="".concat(t.step_num," of ").concat(t.total_steps);var e=document.getElementById("app-prev_step"),n=document.getElementById("app-next_step");e&&(e.style.display=t.show_prev?"inline-block":"none"),n&&(n.textContent=t.step_num===t.total_steps?"Finish":"Next"),this.setupButtonListeners(),this.positionTooltip(t.target,t.placement),this.overlay.classList.remove("d-none"),this.highlightTarget(t.target)}}},{key:"setupButtonListeners",value:function(){if(this.tooltip){var t=document.getElementById("app-end_walkthrough"),e=document.getElementById("app-next_step"),n=document.getElementById("app-prev_step");t&&(t.replaceWith(t.cloneNode(!0)),document.getElementById("app-end_walkthrough").addEventListener("click",(function(){Shiny.setInputValue("app-end_walkthrough",Math.random())}))),e&&(e.replaceWith(e.cloneNode(!0)),document.getElementById("app-next_step").addEventListener("click",(function(){Shiny.setInputValue("app-next_step",Math.random())}))),n&&(n.replaceWith(n.cloneNode(!0)),document.getElementById("app-prev_step").addEventListener("click",(function(){Shiny.setInputValue("app-prev_step",Math.random())})))}}},{key:"positionTooltip",value:function(t,e){var n=document.querySelector(t);if(n&&this.tooltip){var o,i,r=n.getBoundingClientRect(),l=this.tooltip.getBoundingClientRect();switch(e){case"right":o=r.top+r.height/2-l.height/2,i=r.right+15;break;case"left":o=r.top+r.height/2-l.height/2,i=r.left-l.width-15;break;case"bottom":o=r.bottom+15,i=r.left+r.width/2-l.width/2;break;default:o=r.top-l.height-15,i=r.left+r.width/2-l.width/2}o=Math.max(10,Math.min(o,window.innerHeight-l.height-10)),i=Math.max(10,Math.min(i,window.innerWidth-l.width-10)),this.tooltip.style.top="".concat(o,"px"),this.tooltip.style.left="".concat(i,"px")}}},{key:"highlightTarget",value:function(t){this.currentTarget&&this.currentTarget.classList.remove("walkthrough-highlight");var e=document.querySelector(t);e&&(e.classList.add("walkthrough-highlight"),this.currentTarget=e,e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}))}},{key:"hide",value:function(t){this.overlay=document.getElementById("app-walkthrough_overlay"),this.overlay&&this.overlay.classList.add("d-none"),this.currentTarget&&(this.currentTarget.classList.remove("walkthrough-highlight"),this.currentTarget=null)}}])&&n(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();document.addEventListener("DOMContentLoaded",(function(){window.walkthroughManager=new i})),App=t})();